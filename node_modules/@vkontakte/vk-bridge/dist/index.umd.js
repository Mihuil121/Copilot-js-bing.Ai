!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).vkBridge={})}(this,(function(e){"use strict";var n=function(){return n=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},n.apply(this,arguments)};function t(e,n,t){if(t||2===arguments.length)for(var o,r=0,a=n.length;r<a;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}function o(e,t,o){var r=function(e){var n={current:0,next:function(){return++this.current}},t={};return{add:function(o,r){var a=null!=r?r:"".concat(n.next(),"_").concat(e);return t[a]=o,a},resolve:function(e,n,o){var r=t[e];r&&(o(n)?r.resolve(n):r.reject(n),t[e]=null)}}}(o);return t((function(e){if(e.detail&&e.detail.data&&"object"==typeof e.detail.data&&"request_id"in e.detail.data){var n=e.detail.data,t=n.request_id,o=function(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(t[o[r]]=e[o[r]])}return t}(n,["request_id"]);t&&r.resolve(t,o,(function(e){return!("error_type"in e)}))}})),function(t,o){return void 0===o&&(o={}),new Promise((function(a,p){var i=r.add({resolve:a,reject:p},o.request_id);e(t,n(n({},o),{request_id:i}))}))}}var r="undefined"!=typeof window,a=Boolean(r&&window.AndroidBridge),p=Boolean(r&&window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.VKWebAppClose),i=Boolean(r&&window.ReactNativeWebView&&"function"==typeof window.ReactNativeWebView.postMessage),s=r&&!a&&!p,u=s&&/(^\?|&)vk_platform=mobile_web(&|$)/.test(location.search),d=s?"message":"VKWebAppEvent",c=t(["VKWebAppInit","VKWebAppGetCommunityAuthToken","VKWebAppAddToCommunity","VKWebAppAddToHomeScreenInfo","VKWebAppClose","VKWebAppCopyText","VKWebAppCreateHash","VKWebAppGetUserInfo","VKWebAppSetLocation","VKWebAppSendToClient","VKWebAppGetClientVersion","VKWebAppGetPhoneNumber","VKWebAppGetEmail","VKWebAppGetGroupInfo","VKWebAppGetGeodata","VKWebAppGetCommunityToken","VKWebAppGetConfig","VKWebAppGetLaunchParams","VKWebAppSetTitle","VKWebAppGetAuthToken","VKWebAppCallAPIMethod","VKWebAppJoinGroup","VKWebAppLeaveGroup","VKWebAppAllowMessagesFromGroup","VKWebAppDenyNotifications","VKWebAppAllowNotifications","VKWebAppOpenPayForm","VKWebAppOpenApp","VKWebAppShare","VKWebAppShowWallPostBox","VKWebAppScroll","VKWebAppShowOrderBox","VKWebAppShowLeaderBoardBox","VKWebAppShowInviteBox","VKWebAppShowRequestBox","VKWebAppAddToFavorites","VKWebAppShowStoryBox","VKWebAppStorageGet","VKWebAppStorageGetKeys","VKWebAppStorageSet","VKWebAppFlashGetInfo","VKWebAppSubscribeStoryApp","VKWebAppOpenWallPost","VKWebAppCheckAllowedScopes","VKWebAppCheckBannerAd","VKWebAppHideBannerAd","VKWebAppShowBannerAd","VKWebAppCheckNativeAds","VKWebAppShowNativeAds","VKWebAppRetargetingPixel","VKWebAppConversionHit","VKWebAppShowSubscriptionBox","VKWebAppCheckSurvey","VKWebAppShowSurvey","VKWebAppScrollTop","VKWebAppScrollTopStart","VKWebAppScrollTopStop","VKWebAppShowSlidesSheet","VKWebAppTranslate","VKWebAppRecommend","VKWebAppAddToProfile"],s&&!u?["VKWebAppResizeWindow","VKWebAppAddToMenu","VKWebAppShowInstallPushBox","VKWebAppGetFriends","VKWebAppShowCommunityWidgetPreviewBox","VKWebAppCallStart","VKWebAppCallJoin","VKWebAppCallGetStatus"]:["VKWebAppShowImages"],!0),l=r?window.AndroidBridge:void 0,b=p?window.webkit.messageHandlers:void 0,f=s?parent:void 0;var A,v,m,W,V,_,K;e.EAdsFormats=void 0,(A=e.EAdsFormats||(e.EAdsFormats={})).REWARD="reward",A.INTERSTITIAL="interstitial",e.BannerAdLayoutType=void 0,(v=e.BannerAdLayoutType||(e.BannerAdLayoutType={})).RESIZE="resize",v.OVERLAY="overlay",e.BannerAdLocation=void 0,(m=e.BannerAdLocation||(e.BannerAdLocation={})).TOP="top",m.BOTTOM="bottom",e.EGrantedPermission=void 0,(W=e.EGrantedPermission||(e.EGrantedPermission={})).CAMERA="camera",W.LOCATION="location",W.PHOTO="photo",e.EGetLaunchParamsResponseLanguages=void 0,(V=e.EGetLaunchParamsResponseLanguages||(e.EGetLaunchParamsResponseLanguages={})).RU="ru",V.UK="uk",V.UA="ua",V.EN="en",V.BE="be",V.KZ="kz",V.PT="pt",V.ES="es",e.EGetLaunchParamsResponseGroupRole=void 0,(_=e.EGetLaunchParamsResponseGroupRole||(e.EGetLaunchParamsResponseGroupRole={})).ADMIN="admin",_.EDITOR="editor",_.MEMBER="member",_.MODER="moder",_.NONE="none",e.EGetLaunchParamsResponsePlatforms=void 0,(K=e.EGetLaunchParamsResponsePlatforms||(e.EGetLaunchParamsResponsePlatforms={})).DESKTOP_WEB="desktop_web",K.DESKTOP_WEB_MESSENGER="desktop_web_messenger",K.DESKTOP_APP_MESSENGER="desktop_app_messenger",K.MOBILE_WEB="mobile_web",K.MOBILE_ANDROID="mobile_android",K.MOBILE_ANDROID_MESSENGER="mobile_android_messenger",K.MOBILE_IPHONE="mobile_iphone",K.MOBILE_IPHONE_MESSENGER="mobile_iphone_messenger",K.MOBILE_IPAD="mobile_ipad";var w=function(e){var n=void 0,r=[],u=Math.random().toString(36).substring(2,5);function A(e){r.push(e)}function v(){return p||a}function m(){return s&&window.parent!==window}function W(){return v()||m()}function V(e){if(p||a)return t([],r,!0).map((function(n){return n.call(null,e)}));var o=null==e?void 0:e.data;if(s&&o){if(i&&"string"==typeof o)try{o=JSON.parse(o)}catch(e){}var u=o.type,d=o.data,c=o.frameId;u&&("VKWebAppSettings"!==u?t([],r,!0).map((function(e){return e({detail:{type:u,data:d}})})):n=c)}}i&&/(android)/i.test(navigator.userAgent)?document.addEventListener(d,V):"undefined"!=typeof window&&"addEventListener"in window&&window.addEventListener(d,V);var _=o((function(t,o){l&&l[t]?l[t](JSON.stringify(o)):b&&b[t]&&"function"==typeof b[t].postMessage?b[t].postMessage(o):i?window.ReactNativeWebView.postMessage(JSON.stringify({handler:t,params:o})):f&&"function"==typeof f.postMessage&&f.postMessage({handler:t,params:o,type:"vk-connect",webFrameId:n,connectVersion:e},"*")}),A,u);return{send:_,sendPromise:_,subscribe:A,unsubscribe:function(e){var n=r.indexOf(e);n>-1&&r.splice(n,1)},supports:function(e){return a?!(!l||"function"!=typeof l[e]):p?!(!b||!b[e]||"function"!=typeof b[e].postMessage):!!s&&c.includes(e)},isWebView:v,isIframe:m,isEmbedded:W,isStandalone:function(){return!W()}}}("2.12.2");e.applyMiddleware=function e(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return t.includes(void 0)||t.includes(null)?e.apply(void 0,t.filter((function(e){return"function"==typeof e}))):function(e){if(0===t.length)return e;var o,r={subscribe:e.subscribe,send:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e.send.apply(e,n)}},a=t.filter((function(e){return"function"==typeof e})).map((function(e){return e(r)})).reduce((function(e,n){return function(t){return e(n(t))}}));return o=a(e.send),n(n({},e),{send:o})}},e.default=w,e.parseURLSearchParamsForGetLaunchParams=function(n){var t={};try{var o=new URLSearchParams(n);o.forEach((function(n,o){switch(o){case"vk_ts":case"vk_is_recommended":case"vk_profile_id":case"vk_has_profile_button":case"vk_testing_group_id":case"vk_user_id":case"vk_app_id":case"vk_group_id":t[o]=Number(n);break;case"sign":case"vk_chat_id":case"vk_ref":case"vk_access_token_settings":t[o]=n;break;case"odr_enabled":t.odr_enabled="1"===n?1:void 0;break;case"vk_is_app_user":case"vk_are_notifications_enabled":case"vk_is_favorite":t[o]=function(e){switch(e){case"0":return 0;case"1":return 1;default:return}}(n);break;case"vk_language":t.vk_language=function(n){return Object.values(e.EGetLaunchParamsResponseLanguages).some((function(e){return e===n}))}(n)?n:void 0;break;case"vk_viewer_group_role":t.vk_viewer_group_role=function(n){return Object.values(e.EGetLaunchParamsResponseGroupRole).some((function(e){return e===n}))}(n)?n:void 0;break;case"vk_platform":t.vk_platform=function(n){return Object.values(e.EGetLaunchParamsResponsePlatforms).some((function(e){return e===n}))}(n)?n:void 0}}))}catch(e){console.warn(e)}return t},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.js.map

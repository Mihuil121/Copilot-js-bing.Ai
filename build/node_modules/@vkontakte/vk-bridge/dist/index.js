"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){return e=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},e.apply(this,arguments)};function t(e,t,n){if(n||2===arguments.length)for(var o,r=0,a=t.length;r<a;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}function n(t,n,o){var r=function(e){var t={current:0,next:function(){return++this.current}},n={};return{add:function(o,r){var a=null!=r?r:"".concat(t.next(),"_").concat(e);return n[a]=o,a},resolve:function(e,t,o){var r=n[e];r&&(o(t)?r.resolve(t):r.reject(t),n[e]=null)}}}(o);return n((function(e){if(e.detail&&e.detail.data&&"object"==typeof e.detail.data&&"request_id"in e.detail.data){var t=e.detail.data,n=t.request_id,o=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}(t,["request_id"]);n&&r.resolve(n,o,(function(e){return!("error_type"in e)}))}})),function(n,o){return void 0===o&&(o={}),new Promise((function(a,p){var s=r.add({resolve:a,reject:p},o.request_id);t(n,e(e({},o),{request_id:s}))}))}}var o="undefined"!=typeof window,r=Boolean(o&&window.AndroidBridge),a=Boolean(o&&window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.VKWebAppClose),p=Boolean(o&&window.ReactNativeWebView&&"function"==typeof window.ReactNativeWebView.postMessage),s=o&&!r&&!a,i=s&&/(^\?|&)vk_platform=mobile_web(&|$)/.test(location.search),u=s?"message":"VKWebAppEvent",d=t(["VKWebAppInit","VKWebAppGetCommunityAuthToken","VKWebAppAddToCommunity","VKWebAppAddToHomeScreenInfo","VKWebAppClose","VKWebAppCopyText","VKWebAppCreateHash","VKWebAppGetUserInfo","VKWebAppSetLocation","VKWebAppSendToClient","VKWebAppGetClientVersion","VKWebAppGetPhoneNumber","VKWebAppGetEmail","VKWebAppGetGroupInfo","VKWebAppGetGeodata","VKWebAppGetCommunityToken","VKWebAppGetConfig","VKWebAppGetLaunchParams","VKWebAppSetTitle","VKWebAppGetAuthToken","VKWebAppCallAPIMethod","VKWebAppJoinGroup","VKWebAppLeaveGroup","VKWebAppAllowMessagesFromGroup","VKWebAppDenyNotifications","VKWebAppAllowNotifications","VKWebAppOpenPayForm","VKWebAppOpenApp","VKWebAppShare","VKWebAppShowWallPostBox","VKWebAppScroll","VKWebAppShowOrderBox","VKWebAppShowLeaderBoardBox","VKWebAppShowInviteBox","VKWebAppShowRequestBox","VKWebAppAddToFavorites","VKWebAppShowStoryBox","VKWebAppStorageGet","VKWebAppStorageGetKeys","VKWebAppStorageSet","VKWebAppFlashGetInfo","VKWebAppSubscribeStoryApp","VKWebAppOpenWallPost","VKWebAppCheckAllowedScopes","VKWebAppCheckBannerAd","VKWebAppHideBannerAd","VKWebAppShowBannerAd","VKWebAppCheckNativeAds","VKWebAppShowNativeAds","VKWebAppRetargetingPixel","VKWebAppConversionHit","VKWebAppShowSubscriptionBox","VKWebAppCheckSurvey","VKWebAppShowSurvey","VKWebAppScrollTop","VKWebAppScrollTopStart","VKWebAppScrollTopStop","VKWebAppShowSlidesSheet","VKWebAppTranslate","VKWebAppRecommend","VKWebAppAddToProfile"],s&&!i?["VKWebAppResizeWindow","VKWebAppAddToMenu","VKWebAppShowInstallPushBox","VKWebAppGetFriends","VKWebAppShowCommunityWidgetPreviewBox","VKWebAppCallStart","VKWebAppCallJoin","VKWebAppCallGetStatus"]:["VKWebAppShowImages"],!0),c=o?window.AndroidBridge:void 0,l=a?window.webkit.messageHandlers:void 0,b=s?parent:void 0;var A,f,v,m,W,V,_;exports.EAdsFormats=void 0,(A=exports.EAdsFormats||(exports.EAdsFormats={})).REWARD="reward",A.INTERSTITIAL="interstitial",exports.BannerAdLayoutType=void 0,(f=exports.BannerAdLayoutType||(exports.BannerAdLayoutType={})).RESIZE="resize",f.OVERLAY="overlay",exports.BannerAdLocation=void 0,(v=exports.BannerAdLocation||(exports.BannerAdLocation={})).TOP="top",v.BOTTOM="bottom",exports.EGrantedPermission=void 0,(m=exports.EGrantedPermission||(exports.EGrantedPermission={})).CAMERA="camera",m.LOCATION="location",m.PHOTO="photo",exports.EGetLaunchParamsResponseLanguages=void 0,(W=exports.EGetLaunchParamsResponseLanguages||(exports.EGetLaunchParamsResponseLanguages={})).RU="ru",W.UK="uk",W.UA="ua",W.EN="en",W.BE="be",W.KZ="kz",W.PT="pt",W.ES="es",exports.EGetLaunchParamsResponseGroupRole=void 0,(V=exports.EGetLaunchParamsResponseGroupRole||(exports.EGetLaunchParamsResponseGroupRole={})).ADMIN="admin",V.EDITOR="editor",V.MEMBER="member",V.MODER="moder",V.NONE="none",exports.EGetLaunchParamsResponsePlatforms=void 0,(_=exports.EGetLaunchParamsResponsePlatforms||(exports.EGetLaunchParamsResponsePlatforms={})).DESKTOP_WEB="desktop_web",_.DESKTOP_WEB_MESSENGER="desktop_web_messenger",_.DESKTOP_APP_MESSENGER="desktop_app_messenger",_.MOBILE_WEB="mobile_web",_.MOBILE_ANDROID="mobile_android",_.MOBILE_ANDROID_MESSENGER="mobile_android_messenger",_.MOBILE_IPHONE="mobile_iphone",_.MOBILE_IPHONE_MESSENGER="mobile_iphone_messenger",_.MOBILE_IPAD="mobile_ipad";var K=function(e){var o=void 0,i=[],A=Math.random().toString(36).substring(2,5);function f(e){i.push(e)}function v(){return a||r}function m(){return s&&window.parent!==window}function W(){return v()||m()}function V(e){if(a||r)return t([],i,!0).map((function(t){return t.call(null,e)}));var n=null==e?void 0:e.data;if(s&&n){if(p&&"string"==typeof n)try{n=JSON.parse(n)}catch(e){}var u=n.type,d=n.data,c=n.frameId;u&&("VKWebAppSettings"!==u?t([],i,!0).map((function(e){return e({detail:{type:u,data:d}})})):o=c)}}p&&/(android)/i.test(navigator.userAgent)?document.addEventListener(u,V):"undefined"!=typeof window&&"addEventListener"in window&&window.addEventListener(u,V);var _=n((function(t,n){c&&c[t]?c[t](JSON.stringify(n)):l&&l[t]&&"function"==typeof l[t].postMessage?l[t].postMessage(n):p?window.ReactNativeWebView.postMessage(JSON.stringify({handler:t,params:n})):b&&"function"==typeof b.postMessage&&b.postMessage({handler:t,params:n,type:"vk-connect",webFrameId:o,connectVersion:e},"*")}),f,A);return{send:_,sendPromise:_,subscribe:f,unsubscribe:function(e){var t=i.indexOf(e);t>-1&&i.splice(t,1)},supports:function(e){return r?!(!c||"function"!=typeof c[e]):a?!(!l||!l[e]||"function"!=typeof l[e].postMessage):!!s&&d.includes(e)},isWebView:v,isIframe:m,isEmbedded:W,isStandalone:function(){return!W()}}}("2.12.2");exports.applyMiddleware=function t(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return n.includes(void 0)||n.includes(null)?t.apply(void 0,n.filter((function(e){return"function"==typeof e}))):function(t){if(0===n.length)return t;var o,r={subscribe:t.subscribe,send:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.send.apply(t,e)}},a=n.filter((function(e){return"function"==typeof e})).map((function(e){return e(r)})).reduce((function(e,t){return function(n){return e(t(n))}}));return o=a(t.send),e(e({},t),{send:o})}},exports.default=K,exports.parseURLSearchParamsForGetLaunchParams=function(e){var t={};try{var n=new URLSearchParams(e);n.forEach((function(e,n){switch(n){case"vk_ts":case"vk_is_recommended":case"vk_profile_id":case"vk_has_profile_button":case"vk_testing_group_id":case"vk_user_id":case"vk_app_id":case"vk_group_id":t[n]=Number(e);break;case"sign":case"vk_chat_id":case"vk_ref":case"vk_access_token_settings":t[n]=e;break;case"odr_enabled":t.odr_enabled="1"===e?1:void 0;break;case"vk_is_app_user":case"vk_are_notifications_enabled":case"vk_is_favorite":t[n]=function(e){switch(e){case"0":return 0;case"1":return 1;default:return}}(e);break;case"vk_language":t.vk_language=function(e){return Object.values(exports.EGetLaunchParamsResponseLanguages).some((function(t){return t===e}))}(e)?e:void 0;break;case"vk_viewer_group_role":t.vk_viewer_group_role=function(e){return Object.values(exports.EGetLaunchParamsResponseGroupRole).some((function(t){return t===e}))}(e)?e:void 0;break;case"vk_platform":t.vk_platform=function(e){return Object.values(exports.EGetLaunchParamsResponsePlatforms).some((function(t){return t===e}))}(e)?e:void 0}}))}catch(e){console.warn(e)}return t};
//# sourceMappingURL=index.js.map
